{"version":3,"sources":["uni-app:///main.js","webpack:///F:/my/spaceflight/pages/chat/chat.vue?b7e5","webpack:///F:/my/spaceflight/pages/chat/chat.vue?c10c","webpack:///F:/my/spaceflight/pages/chat/chat.vue?ff58","webpack:///F:/my/spaceflight/pages/chat/chat.vue?3251","uni-app:///pages/chat/chat.vue","webpack:///F:/my/spaceflight/pages/chat/chat.vue?72dc","webpack:///F:/my/spaceflight/pages/chat/chat.vue?234a"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,0F;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;AACgB;;;AAGnE;AACgK;AAChK,gBAAgB,6KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAO,CAAC,wCAA+B;;AAElD,WAAW,mBAAO,CAAC,uCAA8B;;AAEjD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC/BA;AAAA;AAAA;AAAA;AAAklB,CAAgB,8mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC+PtmB;AACA;AACA,8D;AACA;AACA;AACA;AACA,iBADA;AAEA,mBAFA;AAGA,qBAHA;AAIA,uBAJA;AAKA,eALA,CAKA;AALA,E;AAOA;AACA,MADA,kBACA;AACA;AACA,wBADA;AAEA,sBAFA;AAGA,oBAHA;AAIA,qBAJA;AAKA,eALA;AAMA,wBANA;AAOA,uBAPA;AAQA,oBARA;AASA,oBATA;AAUA,qBAVA;AAWA,oCAXA;AAYA,kCAZA;AAaA,kCAbA;AAcA,eAdA;AAeA,yBAfA;AAgBA,sBAhBA;AAiBA,gBAjBA;AAkBA;AACA,+BAnBA;AAoBA,oBApBA;AAqBA,2BArBA;AAsBA,yBAtBA;AAuBA,sBAvBA;AAwBA,oBAxBA;AAyBA,qBAzBA;AA0BA,wBA1BA;AA2BA,mBA3BA;AA4BA,mBA5BA;AA6BA,mBA7BA;AA8BA,sBA9BA;AA+BA,aA/BA;AAgCA,mBAhCA;AAiCA,6EAjCA;AAkCA,qBAlCA;AAmCA,yBAnCA;AAoCA,gJApCA;AAqCA,wBArCA;AAsCA,uBAtCA;AAuCA,oBAvCA;AAwCA,uBAxCA;;AA0CA,GA5CA;AA6CA,QA7CA,oBA6CA;AACA;AACA;AACA;AACA;AACA,KAFA,EAEA,IAFA;AAGA,GAnDA;AAoDA,QApDA,kBAoDA,OApDA,EAoDA;AACA;AACA;AACA;AACA;AACA,qBADA;;AAGA;AACA;AACA;AACA;AACA;AACA,YADA,CACA,OADA;AAEA,wBAFA,CAEA;AACA;AACA;AACA;AACA,OANA;AAOA,UAPA;AAQA,KATA;AAUA;AACA;AACA;AACA;AACA;AACA,KALA,EAKA,GALA;AAMA;AACA;AACA;AACA;AACA,KAHA;AAIA;AACA;AACA,KAFA;AAGA;AACA;AACA,KAFA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,2BADA;;AAGA,SAJA,MAIA;AACA;AACA,8CADA;AAEA,0EAFA;AAGA;AACA,uBADA,EAHA;;;AAOA;AACA;AACA;AACA;AACA,KApBA;AAqBA,GA9GA;AA+GA,SA/GA,qBA+GA;AACA;AACA;AACA;AACA;;AAEA,GArHA;AAsHA;AACA,UAvHA,sBAuHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAzIA;AA0IA,mBA1IA,+BA0IA;AACA;AACA;AACA,GA7IA;AA8IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAHA;AAIA,6GAJA;AAKA,8DALA;AAMA,sEANA,GADA;;AASA,sCATA,CAlJA;;AA6JA;AACA,YADA,oBACA,CADA,EACA;AACA;AACA,KAHA;AAIA;AACA,mBALA,2BAKA,CALA,EAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAbA;AAcA,gBAdA,0BAcA;AACA;AACA,KAhBA;AAiBA;AACA,mBAlBA,2BAkBA,CAlBA,EAkBA;AACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA;AACA;AACA;AACA,KA/BA;AAgCA;AACA,kBAjCA,4BAiCA;AACA;AACA;AACA;AACA,KArCA;AAsCA;AACA,kBAvCA,4BAuCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCADA;AAEA,mCAFA;AAGA,kCAHA;;AAKA,iBANA,MAMA;AACA;AACA,iCADA;AAEA,gCAFA;AAGA,kCAHA;;AAKA;AACA,eAhBA;;AAkBA,WApBA,MAoBA;AACA;AACA;AACA;AACA,WAJA,MAIA;AACA;AACA;AACA,mCADA;AAEA;AACA;AACA,+BADA;AAEA,iCAFA;AAGA,gCAHA;;AAKA,eARA;;AAUA;AACA,SAxCA;AAyCA;AACA;AACA,yBADA;AAEA,wBAFA;AAGA,0BAHA;;AAKA,SA/CA;;AAiDA,KAzFA;AA0FA;AACA,kBA3FA,4BA2FA;AACA;AACA;AACA,0BADA;;AAGA;AACA,KAjGA;AAkGA,eAlGA,yBAkGA;AACA;AACA;AACA,KArGA;AAsGA,qBAtGA,+BAsGA;AACA;AACA;AACA,uBADA;;AAGA;AACA;AACA;AACA,yCADA;AAEA,qEAFA;AAGA;AACA,+BADA;AAEA,6CAFA;AAGA,yCAHA,EAHA;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA,KA5HA;AA6HA;AACA,aA9HA,uBA8HA;AACA;AACA,KAhIA;AAiIA;AACA,mBAlIA,6BAkIA;AACA;AACA;AACA,mBADA;AAEA,6BAFA;AAGA;AACA;AACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA,SAVA;;AAYA;AACA,KAjJA;AAkJA;AACA,kBAnJA,0BAmJA,OAnJA,EAmJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA,+BADA;AAEA,sBAFA;AAGA,wBAHA;;AAKA;AACA,KAjKA;AAkKA,YAlKA,sBAkKA;AACA;AACA;AACA,sCADA;AAEA;AACA;AACA,SAJA;AAKA;AACA;AACA,2BADA;AAEA,wBAFA;AAGA,0BAHA;;AAKA;AACA,SAZA;AAaA;AACA;AACA;AACA,sCADA;AAEA;AACA;AACA;AACA,+BADA;AAEA,4BAFA;AAGA,8BAHA;;AAKA;AACA;AACA,aAXA;AAYA;AACA;AACA;AACA,qCADA;AAEA,4BAFA;AAGA,8BAHA;;AAKA;AACA,aApBA;;AAsBA,SArCA;;AAuCA;AACA;AACA,OAFA;AAGA,KA9MA;AA+MA;AACA,YAhNA,2BAgNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA,KA7NA;AA8NA;AACA,kBA/NA,4BA+NA;AACA;AACA;AACA;AACA;AACA,KApOA;AAqOA;AACA,eAtOA,yBAsOA;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA,KA/OA;AAgPA;AACA,cAjPA,wBAiPA;AACA;AACA;AACA;AACA;AACA,OAJA,MAIA;AACA;AACA;AACA;AACA,KA1PA;AA2PA;AACA,eA5PA,yBA4PA;AACA;AACA;AACA;AACA;AACA,KAjQA;AAkQA,UAlQA,kBAkQA,OAlQA,EAkQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAzQA;AA0QA;AACA,eA3QA,yBA2QA;AACA;AACA;AACA,2CADA;AAEA,uEAFA;AAGA,gDAHA;;AAKA;AACA;AACA;AACA;AACA,SAFA;AAGA;AACA,OAZA,MAYA;AACA;AACA;AACA;AACA;AACA;AACA,KA9RA;AA+RA,aA/RA,qBA+RA,IA/RA,EA+RA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,qCADA;AAEA;AACA;AACA,iBAJA;;AAMA,aARA,MAQA;AACA;AACA;AACA,WAbA;;AAeA;AACA,KApTA;AAqTA,cArTA,sBAqTA,CArTA,EAqTA;AACA;AACA;AACA,8GADA;AAEA,sBAFA;;AAIA,KA3TA;AA4TA,eA5TA,uBA4TA,IA5TA,EA4TA;AACA;AACA;AACA;AACA,0BADA;AAEA,gBAFA;AAGA;AACA;AACA,6CADA;AAEA,yEAFA;AAGA;AACA,uBADA,EAHA;;AAMA;AACA;AACA,aARA;;AAUA;AACA;AACA,qBADA,CACA,OADA;AAEA,cAFA,CAEA;AACA;AACA,WAJA;AAKA,eALA,CAKA;AACA;AACA,WAPA;AAQA,SAvBA;;AAyBA;AACA,KAzVA;AA0VA,gBA1VA,wBA0VA,GA1VA,EA0VA;AACA;AACA,oBADA,EACA;AACA,mBAFA;;AAIA,KA/VA;AAgWA;AACA,eAjWA,uBAiWA,IAjWA,EAiWA;AACA;AACA,KAnWA;AAoWA;AACA,gBArWA,wBAqWA,OArWA,EAqWA;AACA;AACA;AACA;AACA,KAzWA;AA0WA,cA1WA,wBA0WA;AACA;AACA;AACA,2CADA;AAEA,uEAFA;AAGA;AACA,0BADA;AAEA,0CAFA;AAGA,2CAHA,EAHA;;;AASA;AACA;AACA;AACA;AACA;AACA,OAfA,MAeA;AACA;AACA,2BADA;;AAGA;AACA,KA/XA;AAgYA;AACA,aAjYA,qBAiYA,KAjYA,EAiYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA;AAGA;AACA;AACA,iCADA;AAEA,sBAFA;AAGA,wBAHA;;AAKA,OANA;AAOA,KAhZA;AAiZA;AACA,SAlZA,mBAkZA;AACA;AACA;AACA,uCADA;AAEA,uBAFA;AAGA,sBAHA;AAIA,eAJA,mBAIA,GAJA,EAIA;AACA;AACA,6CADA;AAEA,yEAFA;AAGA;AACA,uBADA,EAHA;;;AAOA;AACA;AACA;AACA,SAfA;;AAiBA,KAraA;AAsaA,gBAtaA,wBAsaA,GAtaA,EAsaA,GAtaA,EAsaA;AACA;AACA;AACA;AACA,KA1aA;AA2aA,aA3aA,uBA2aA;AACA;AACA,mBADA;AAEA,kBAFA;AAGA,4CAHA;AAIA,iBAJA;AAKA,mBALA;AAMA,wBANA;;AAQA;AACA;AACA,yCADA;AAEA,qEAFA;AAGA;AACA,oBADA;AAEA,yBAFA;AAGA,uBAHA,EAHA;;;AASA;AACA;AACA;AACA;AACA;AACA,KAncA;AAocA,mBApcA,6BAocA;AACA;AACA;AACA,KAvcA;AAwcA,sBAxcA,gCAwcA;AACA;AACA;AACA,KA3cA;AA4cA,kBA5cA,0BA4cA,IA5cA,EA4cA;AACA;AACA,yCADA;AAEA,qEAFA;AAGA;AACA,kBADA;AAEA,oBAFA,EAHA;;;AAQA;AACA;AACA;AACA,KAxdA;AAydA;AACA,iBA1dA,yBA0dA,OA1dA,EA0dA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBADA;AAEA,iCAFA;AAGA;AACA;AACA;AACA;AACA,eAHA,MAGA;AACA;AACA;AACA,aAVA;;AAYA;AACA;AACA;AACA,KAhfA;AAifA;AACA,uBAlfA,iCAkfA;AACA;AACA;AACA;AACA;AACA,uBADA;AAEA,uBAFA;;AAIA,OAPA;AAQA,KA3fA;AA4fA;AACA,UA7fA,kBA6fA,OA7fA,EA6fA;AACA;AACA,KA/fA,EA7JA;;AA8pBA,SA9pBA,qBA8pBA,EA9pBA,E;;;;;;;;;;;;;AC3QA;AAAA;AAAA;AAAA;AAAklC,CAAgB,+jCAAG,EAAC,C;;;;;;;;;;;ACAtmC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/chat/chat.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=bf16e7f4&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat.vue\"\nexport default component.exports","export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=bf16e7f4&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var m0 = require(\"../../static/images/smile.png\")\n\n  var m1 = require(\"../../static/images/more.png\")\n\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.isFocus = true\n    }\n\n    _vm.e1 = function($event) {\n      _vm.isFocus = false\n    }\n  }\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        m0: m0,\n        m1: m1\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\r\n\t<div\r\n\t\tclass=\"chat\"\r\n\t\tid=\"chat\"\r\n\t\t:style=\"{ paddingBottom: isIphoneX ? safeBottom + 70 + 'px' : '70px','min-height': sysInfo.windowHeight+'px'}\"\r\n\t\t@longpress=\"handleLongPress\"\r\n\t\t@touchmove=\"handleTouchMove\"\r\n\t\t@touchend=\"handleTouchEnd\"\r\n\t\t\r\n\t>\r\n\t\t<div :class=\"isRecording ? '' : 'modal-display'\" class=\"record-modal\">\r\n\t\t\t<div class=\"wrapper\"><div class=\"modal-loading\"></div></div>\r\n\t\t\t<div class=\"modal-title\">{{ title }}</div>\r\n\t\t</div>\r\n\t\t<!--    <i-modal title=\"确认下载？\" :visible=\"modalVisible\" @ok=\"download\" @cancel=\"handleModalShow\">\r\n      <div class=\"input-wrapper\">\r\n        进度{{percent}}%\r\n      </div>\r\n    </i-modal>\r\n    <i-modal title=\"发送自定义消息\" :visible=\"customModalVisible\" @ok=\"sendCustomMessage\" @cancel=\"customModal\">\r\n      <div class=\"custom-wrapper\">\r\n        <input type=\"text\" class=\"custom-input\" :class=\"{'input-focus': focusedInput === 'data'}\" placeholder=\"输入数据\" v-model.lazy:value=\"customData\" @focus=\"focusedInput = 'data'\" @blur=\"focusedInput = ''\"/>\r\n        <input type=\"text\" class=\"custom-input\" :class=\"{'input-focus': focusedInput === 'desc'}\" placeholder=\"输入描述\" v-model.lazy:value=\"customDescription\" @focus=\"focusedInput = 'desc'\" @blur=\"focusedInput = ''\"/>\r\n        <input type=\"text\" class=\"custom-input\" :class=\"{'input-focus': focusedInput === 'ext'}\" placeholder=\"输入其他\" v-model.lazy:value=\"customExtension\" @focus=\"focusedInput = 'ext'\" @blur=\"focusedInput = ''\"/>\r\n      </div>\r\n    </i-modal>\r\n    <i-modal title=\"对IM demo的评分和评价\" i-class=\"custom-modal\" :visible=\"rateModal\" @ok=\"sendSurvey\" @cancel=\"rateModal = false\">\r\n      <div class=\"custom-wrapper\">\r\n        <i-rate\r\n          @change=\"onChange\"\r\n          :value=\"rate\">\r\n        </i-rate>\r\n        <input type=\"text\" class=\"custom-input\" placeholder=\"输入评价\" v-model.lazy:value=\"customExtension\"/>\r\n      </div>\r\n    </i-modal>\r\n    <i-modal \r\n      title=\"提示\"\r\n      i-class=\"custom-modal\"\r\n      :visible=\"revokeModal\"\r\n      @ok=\"handleRevokeMessage\"\r\n      @cancel=\"revokeModal = false\">\r\n      <div class=\"custom-wrapper\">\r\n        确定要撤回本消息吗？\r\n      </div>\r\n    </i-modal> -->\r\n\t\t<div id=\"list\" @click=\"loseFocus\">\r\n\t\t\t<li v-for=\"(message, index) in currentMessageList\" :key=\"index\">\r\n\t\t\t\t<!--        系统消息-->\r\n\t\t\t\t<div class=\"notice\" v-if=\"message.type === 'TIMGroupTipElem' || message.type === 'TIMGroupSystemNoticeElem'\">\r\n\t\t\t\t\t<div class=\"content\">\r\n\t\t\t\t\t\t<span v-for=\"(div, index1) in message.virtualDom\" :key=\"message.ID + index1\">\r\n\t\t\t\t\t\t\t<span v-if=\"div.name === 'groupTip' || 'system'\">{{ div.text }}</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!--        撤回的消息-->\r\n\t\t\t\t<div v-else-if=\"message.isRevoked\" :key=\"message.ID\">\r\n\t\t\t\t\t<div class=\"notice\">\r\n\t\t\t\t\t\t<div class=\"content\">\r\n\t\t\t\t\t\t\t<template v-if=\"message.from === myInfo.userID\">\r\n\t\t\t\t\t\t\t\t你撤回了一条消息\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t{{ message.from }}撤回了一条消息\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<template v-if=\"message.from === myInfo.userID\">\r\n\t\t\t\t\t\t\t<div v-if=\"currentTime - message.time < 120 && message.type === 'TIMTextElem'\" @click=\"reEdit(message)\" class=\"re-edit\">重新编辑</div>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<!--        非系统消息-->\r\n\t\t\t\t<div v-else :class=\"message.flow === 'out' ? 'item-right' : 'item-left'\">\r\n\t\t\t\t\t<div class=\"content\">\r\n\t\t\t\t\t\t<div class=\"name\">\r\n\t\t\t\t\t\t\t<template v-if=\"currentConversation.type === 'C2C'\">\r\n\t\t\t\t\t\t\t\t<template v-if=\"message.flow === 'in'\">\r\n\t\t\t\t\t\t\t\t\t{{ currentConversation.userProfile.nick || currentConversation.userProfile.userID }}\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t\t{{ myInfo.nick || myInfo.userID }}\r\n\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t\t{{ message.nameCard || message.nick || message.from }}\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"wrapper\" @longpress=\"handleMessage(message)\">\r\n\t\t\t\t\t\t\t<div class=\"load\" @click=\"handleResend(message)\" v-if=\"message.from === myInfo.userID\"><div :class=\"message.status\"></div></div>\r\n\t\t\t\t\t\t\t<div class=\"message\" v-if=\"message.type === 'TIMTextElem'\">\r\n\t\t\t\t\t\t\t\t<div class=\"text-message\">\r\n\t\t\t\t\t\t\t\t\t<span v-for=\"(div, index2) in message.virtualDom\" :key=\"message.ID + index2\">\r\n\t\t\t\t\t\t\t\t\t\t<span v-if=\"div.name === 'span'\">{{ div.text }}</span>\r\n\t\t\t\t\t\t\t\t\t\t<image v-if=\"div.name === 'img'\" :src=\"div.src\" style=\"width:20px;height:20px;\" />\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div  class=\"arrow\"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<image\r\n\t\t\t\t\t\t\t\tclass=\"image-message\"\r\n\t\t\t\t\t\t\t\tv-else-if=\"message.type === 'TIMImageElem'\"\r\n\t\t\t\t\t\t\t\t:src=\"message.payload.imageInfoArray[1].url\"\r\n\t\t\t\t\t\t\t\tmode=\"widthFix\"\r\n\t\t\t\t\t\t\t\t@click=\"previewImage(message.payload.imageInfoArray[1].url)\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div class=\"message\" v-else-if=\"message.type === 'TIMFileElem'\">\r\n\t\t\t\t\t\t\t\t<div class=\"file\" @click=\"handleDownload(message.payload)\">\r\n\t\t\t\t\t\t\t\t\t<image src=\"../../../static/images/file.png\"></image>\r\n\t\t\t\t\t\t\t\t\t<div>{{ message.payload.fileName }}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"message\" v-else-if=\"message.type === 'TIMCustomElem'\">\r\n\t\t\t\t\t\t\t\t<div v-if=\"message.payload.data === 'survey'\" class=\"survey\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"title\">对IM DEMO的评分和建议</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"description\">\r\n\t\t\t\t\t\t\t\t\t\t<!--           <i-rate\r\n                      disabled=\"true\"\r\n                      :value=\"message.payload.description\">\r\n                    </i-rate> -->\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"suggestion\">\r\n\t\t\t\t\t\t\t\t\t\t<div>{{ message.payload.extension }}</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div v-else-if=\"message.payload.data === 'group_create'\">\r\n\t\t\t\t\t\t\t\t\t<div>{{ message.payload.extension }}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div v-else-if=\"message.virtualDom[0].name === 'videoCall'\" class=\"custom-elem\">\r\n\t\t\t\t\t\t\t\t\t<div>{{ message.virtualDom[0].text }}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div v-else class=\"custom-elem\">自定义消息</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"message\" v-else-if=\"message.type === 'TIMSoundElem'\" :url=\"message.payload.url\">\r\n\t\t\t\t\t\t\t\t<div class=\"box\" @click=\"openAudio(message.payload)\">\r\n\t\t\t\t\t\t\t\t\t<image src=\"/static/images/audio-play.png\" style=\"height:22px;width:22px\" />\r\n\t\t\t\t\t\t\t\t\t<div style=\"padding-left: 4px;\">{{ message.payload.second }}s</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div  class=\"arrow\"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"message\" v-else-if=\"message.type === 'TIMFaceElem'\">\r\n\t\t\t\t\t\t\t\t不支持的消息类型\r\n\t\t\t<!-- \t\t\t\t\t<div class=\"custom-elem\">\r\n\t\t\t\t\t\t\t\t\t<image v-if=\"message.payload.data.indexOf('@') > 0\" :src=\"faceUrl + message.payload.data + '.png'\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"height:90px; width:90px\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<image v-else :src=\"faceUrl + message.payload.data + '@2x.png'\"\r\n\t\t\t\t\t\t\t\t\t\tstyle=\"height:90px; width:90px\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t\t\t\t<div  class=\"arrow\"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"message\" v-else-if=\"message.type === 'TIMVideoFileElem'\">\r\n\t\t\t\t\t\t\t\t<video :src=\"message.payload.videoUrl\" class=\"video\" :poster=\"message.payload.thumbUrl\" object-fit=\"contain\" @error=\"videoError\"></video>\r\n\t\t\t\t\t\t\t\t<div  class=\"arrow\"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<!-- 自己发的消息头像 -->\r\n\t\t\t\t\t\t<image class=\"avatar\" v-if=\"message.flow === 'out'\" :src=\"myInfo.avatar?myInfo.avatar:'../../static/images/avatar.png'\" />\r\n\t\t\t\t\t\t<!-- 收到的消息头像 -->\r\n\t\t\t\t\t\t<image class=\"avatar\" shape=\"square\" v-else-if=\"currentConversation.type === 'C2C'\" @click=\"toDetail\" :src=\"currentConversation.userProfile.avatar?currentConversation.userProfile.avatar:'../../static/images/avatar.png'\"></image>\r\n\t\t\t\t\t\t<image class=\"avatar\" shape=\"square\" v-else @click=\"toDetail({ userID: message.from })\" :src=\"message.avatar?message.avatar:'../../static/images/avatar.png'\"></image>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</li>\r\n\t\t</div>\r\n\t\t<!--    输入框及选择框部分-->\r\n\t\t<div class=\"bottom\" :style=\"{ paddingBottom: isIphoneX ? safeBottom + 'px' : '' }\">\r\n\t\t\t<div class=\"bottom-div\" :style=\"{ marginBottom: isFocus ? '10px' : 0 }\">\r\n\t\t\t\t<div class=\"btn-left\" @click=\"chooseRecord\"><image :src=\"!isRecord ? '../../static/images/audio.png' : '../../static/images/record.png'\" style=\"width: 28px;height: 28px;\" /></div>\r\n\t\t\t\t<div v-if=\"!isRecord\" style=\"width: 100%\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tclass=\"input\"\r\n\t\t\t\t\t\tv-model.lazy:value=\"messageContent\"\r\n\t\t\t\t\t\tconfirm-type=\"send\"\r\n\t\t\t\t\t\t:focus=\"isFocus\"\r\n\t\t\t\t\t\t@focus=\"isFocus = true\"\r\n\t\t\t\t\t\t@blur=\"isFocus = false\"\r\n\t\t\t\t\t\t@confirm=\"sendMessage\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"record\" id=\"record\" v-if=\"isRecord\">\r\n\t\t\t\t\t<template v-if=\"!isRecording\">\r\n\t\t\t\t\t\t按住 说话\r\n\t\t\t\t\t</template>\r\n\t\t\t\t\t<template v-if=\"isRecording\">\r\n\t\t\t\t\t\t抬起 停止\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"btn\" @click=\"handleEmoji()\"><img src=\"../../static/images/smile.png\" style=\"width: 28px;height: 28px;\"></div>\r\n\t\t\t\t<view class=\"send bg-blue\" @click=\"sendMessage\" v-if=\"messageContent.length !== 0\">发送</view>\r\n\t\t\t\t<div class=\"btn\" @click=\"handleMore()\" v-else><img src=\"../../static/images/more.png\" style=\"width: 28px;height: 28px;\"></div>\r\n\t\t\t</div>\r\n\t\t\t<!--    emoji部分-->\r\n\t\t\t<div class=\"bottom-emoji\" v-if=\"isEmojiOpen\">\r\n\t\t\t\t<div class=\"emoji-tab\">\r\n\t\t\t\t\t<div class=\"tabs\">\r\n\t\t\t\t\t\t<div class=\"single\" @click=\"handleEmojiShow\" :class=\"emojiShow ? 'choosed' : ''\">\r\n\t\t\t\t\t\t\t<image src=\"/static/images/smile.png\" style=\"width:100%;height:100%\"></image>\r\n\t\t\t\t\t\t</div>\r\n\t\t<!-- \t\t\t\t<div class=\"single\" @click=\"handleBigEmojiShow\" :class=\"bigEmojiShow ? 'choosed' : ''\">\r\n\t\t\t\t\t\t\t<image :src=\"faceUrl + 'tt16@2x.png'\" style=\"width:100%;height:100%\"></image>\r\n\t\t\t\t\t\t</div> -->\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"emojis\" v-if=\"emojiShow\">\r\n\t\t\t\t\t<div v-for=\"(emojiItem, index3) in emojiName\" class=\"emoji\" :key=\"emojiItem\" @click=\"chooseEmoji(emojiItem)\">\r\n\t\t\t\t\t\t<image :src=\"emojiUrl + emojiMap[emojiItem]\" style=\"width:100%;height:100%\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"emojis\" v-if=\"bigEmojiShow\">\r\n\t\t\t\t\t<div v-for=\"(bigItem, index4) in bigEmoji\" class=\"bigemoji\" :key=\"bigItem\" @click=\"chooseBigEmoji(bigItem)\">\r\n\t\t\t\t\t\t<image :src=\"faceUrl + bigItem + '@2x.png'\" style=\"width:100%;height:100%\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<!--    更多部分-->\r\n\t\t\t<div class=\"bottom-image\" v-if=\"isMoreOpen\">\r\n\t\t\t\t<div class=\"images\">\r\n\t\t\t\t\t<div class=\"block\" @click=\"sendPhoto('camera')\">\r\n\t\t\t\t\t\t<div class=\"image\"><image src=\"/static/images/take-pic.png\" class=\"icon\" /></div>\r\n\t\t\t\t\t\t<div class=\"name\">拍摄</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"block\" @click=\"sendPhoto('album')\">\r\n\t\t\t\t\t\t<div class=\"image\"><image src=\"/static/images/picture.png\" class=\"icon\" /></div>\r\n\t\t\t\t\t\t<div class=\"name\">图片</div>\r\n\t\t\t\t\t</div>\r\n\t\t<!-- \t\t\t<div class=\"block\" @click=\"customModal()\">\r\n\t\t\t\t\t\t<div class=\"image\"><image src=\"/static/images/custom.png\" class=\"icon\" /></div>\r\n\t\t\t\t\t\t<div class=\"name\">自定义消息</div>\r\n\t\t\t\t\t</div> -->\r\n<!-- \t\t\t\t\t<div class=\"block\" @click=\"rateModal = true\">\r\n\t\t\t\t\t\t<div class=\"image\"><image src=\"/static/images/rating.png\" class=\"icon\" /></div>\r\n\t\t\t\t\t\t<div class=\"name\">评分</div>\r\n\t\t\t\t\t</div> -->\r\n\t\t\t<!-- \t</div>\r\n\t\t\t\t<div class=\"images\"> -->\r\n\t\t\t\t\t<div class=\"block\" @click=\"video\">\r\n\t\t\t\t\t\t<div class=\"image\"><image src=\"/static/images/video-file.png\" class=\"icon\" /></div>\r\n\t\t\t\t\t\t<div class=\"name\">视频</div>\r\n\t\t\t\t\t</div>\r\n<!-- \t\t\t\t\t<div class=\"block\" @click=\"videoCall\" v-if=\"currentConversation.type === 'C2C'\">\r\n\t\t\t\t\t\t<div class=\"image\"><image src=\"/static/images/video.png\" class=\"icon\" /></div>\r\n\t\t\t\t\t\t<div class=\"name\">视频通话</div>\r\n\t\t\t\t\t</div> -->\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapGetters } from 'vuex';\r\nimport { emojiName, emojiMap, emojiUrl } from '../../utils/emojiMap';\r\nimport { throttle } from '../../utils/index';\r\nconst audioContext = wx.createInnerAudioContext();\r\nconst recorderManager = wx.getRecorderManager();\r\nconst recordOptions = {\r\n\tduration: 60000,\r\n\tsampleRate: 44100,\r\n\tnumberOfChannels: 1,\r\n\tencodeBitRate: 192000,\r\n\tformat: 'aac' // 音频格式，选择此格式创建的音频消息，可以在即时通信 IM 全平台（Android、iOS、微信小程序和Web）互通\r\n};\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tmessageContent: '',\r\n\t\t\tconversation: {},\r\n\t\t\tmessageKey: '',\r\n\t\t\tlastMsgTime: '',\r\n\t\t\tcount: 15,\r\n\t\t\tisEmojiOpen: false,\r\n\t\t\tisMoreOpen: false,\r\n\t\t\tisFocus: false,\r\n\t\t\tisGroup: false,\r\n\t\t\tmessageList: [],\r\n\t\t\temojiName: emojiName,\r\n\t\t\temojiMap: emojiMap,\r\n\t\t\temojiUrl: emojiUrl,\r\n\t\t\theight: 0,\r\n\t\t\tmodalVisible: false,\r\n\t\t\tdownloadInfo: {},\r\n\t\t\tpercent: 0,\r\n\t\t\t// sysInfo: {},\r\n\t\t\tcustomModalVisible: false,\r\n\t\t\tcustomData: '',\r\n\t\t\tcustomDescription: '',\r\n\t\t\tcustomExtension: '',\r\n\t\t\tfocusedInput: '',\r\n\t\t\tsafeBottom: 34,\r\n\t\t\tisRecord: false,\r\n\t\t\tisRecording: false,\r\n\t\t\tcanSend: true,\r\n\t\t\tstartPoint: 0,\r\n\t\t\ttitle: '正在录音',\r\n\t\t\trateModal: false,\r\n\t\t\trate: 5,\r\n\t\t\tisShow: false,\r\n\t\t\tfaceUrl: 'https://webim-1252463788.file.myqcloud.com/assets/face-elem/',\r\n\t\t\temojiShow: true,\r\n\t\t\tbigEmojiShow: false,\r\n\t\t\tbigEmoji: ['tt01', 'tt02', 'tt03', 'tt04', 'tt05', 'tt06', 'tt07', 'tt08', 'tt09', 'tt10', 'tt11', 'tt12', 'tt13', 'tt14', 'tt15', 'tt16'],\r\n\t\t\trevokeModal: false,\r\n\t\t\trevokeMessage: {},\r\n\t\t\tcurrentTime: 0,\r\n\t\t\tcurrentTimeID: ''\r\n\t\t};\r\n\t},\r\n\tonShow() {\r\n\t\tthis.isShow = true;\r\n\t\tconst that = this;\r\n\t\tthis.currentTimeID = setInterval(function() {\r\n\t\t\tthat.currentTime = new Date().getTime() / 1000;\r\n\t\t}, 3000);\r\n\t},\r\n\tonLoad(options) {\r\n\t\tconsole.log('onLoad')\r\n\t\tthis.set = options.toAccount;\r\n\t\t// 设置header——聊天对象昵称或群名\r\n\t\twx.setNavigationBarTitle({\r\n\t\t\ttitle: this.set\r\n\t\t});\r\n\t\tthis.height = this.sysInfo.windowHeight;\r\n\t\tlet query = wx.createSelectorQuery();\r\n\t\tlet that = this;\r\n\t\twx.$app.on(this.TIM.EVENT.MESSAGE_RECEIVED, () => {\r\n\t\t\tquery\r\n\t\t\t\t.select('#chat')\r\n\t\t\t\t.boundingClientRect(function(res) {\r\n\t\t\t\t\tif (res.bottom - that.height < 150) {\r\n\t\t\t\t\t\tthat.scrollToBottom();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.exec();\r\n\t\t});\r\n\t\tlet interval = setInterval(() => {\r\n\t\t\tif (this.currentMessageList.length !== 0) {\r\n\t\t\t\tthis.scrollToBottom();\r\n\t\t\t\tclearInterval(interval);\r\n\t\t\t}\r\n\t\t}, 600);\r\n\t\tthis.$bus.$off('atUser');\r\n\t\tthis.$bus.$on('atUser', user => {\r\n\t\t\tthis.messageContent += user.userID;\r\n\t\t\tthis.messageContent += ' ';\r\n\t\t});\r\n\t\trecorderManager.onStart(() => {\r\n\t\t\tconsole.log('recorder start');\r\n\t\t});\r\n\t\trecorderManager.onPause(() => {\r\n\t\t\tconsole.log('recorder pause');\r\n\t\t});\r\n\t\trecorderManager.onStop(res => {\r\n\t\t\tconsole.log('recorder stop');\r\n\t\t\twx.hideLoading();\r\n\t\t\tif (this.canSend) {\r\n\t\t\t\tif (res.duration < 1000) {\r\n\t\t\t\t\tthis.$store.commit('showToast', {\r\n\t\t\t\t\t\ttitle: '录音时间太短'\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst message = wx.$app.createAudioMessage({\r\n\t\t\t\t\t\tto: this.$store.getters.toAccount,\r\n\t\t\t\t\t\tconversationType: this.$store.getters.currentConversationType,\r\n\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\tfile: res\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.$store.commit('sendMessage', message);\r\n\t\t\t\t\twx.$app.sendMessage(message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tonReady() {\r\n\t\t// let that = this\r\n\t\t// setTimeout(()=>{\r\n\t\t// \tthat.getMessageList()\r\n\t\t// })\r\n\t\t\r\n\t},\r\n\t// 退出聊天页面的时候所有状态清空\r\n\tonUnload() {\r\n\t\tclearInterval(this.currentTimeID);\r\n\t\twx.$app.setMessageRead({ conversationID: this.$store.state.conversation.currentConversationID });\r\n\t\tthis.isEmojiOpen = false;\r\n\t\tthis.rateModal = false;\r\n\t\tthis.isMoreOpen = false;\r\n\t\tthis.messageContent = '';\r\n\t\tthis.isShow = false;\r\n\t\t// eslint-disable-next-line\r\n\t\tconst pages = getCurrentPages();\r\n\t\t// 若是由群组会话跳转到C2C会话，则在C2C会话 unload （返回上一层页面） 时，跳转到index页\r\n\t\t// 原因：若直接从C2C会话返回群组会话，由于此时currentConversation和currentMessageList已变更，会导致数据不一致的问题，简单起见，直接跳回index\r\n\t\t// const hasGroupChat = pages.find(item => item.options.type === this.TIM.TYPES.CONV_GROUP);\r\n\t\t// if (hasGroupChat) {\r\n\t\t// \twx.switchTab({\r\n\t\t// \t\turl: '../index/main'\r\n\t\t// \t});\r\n\t\t// }\r\n\t},\r\n\tonPullDownRefresh(){\r\n\t\tconsole.log('onPullDownRefresh')\r\n\t\tthrottle(this.getMessageList, 1000)()\r\n\t},\r\n\t// onPullDownRefresh() {\r\n\t// \t console.log('onPullDownRefresh')\r\n\t// \tthrottle(this.getMessageList, 1000)();\r\n\t// },\r\n\tcomputed: {\r\n\t\t...mapState({\r\n\t\t\tcurrentMessageList: state => {\r\n\t\t\t\treturn state.conversation.currentMessageList;\r\n\t\t\t},\r\n\t\t\tcurrentConversation: state => state.conversation.currentConversation,\r\n\t\t\tmyInfo: state => state.user.myInfo,\r\n\t\t\tsysInfo: state => state.global.systemInfo\r\n\t\t}),\r\n\t\t...mapGetters(['isIphoneX'])\r\n\t},\r\n\tmethods: {\r\n\t\tonChange(e) {\r\n\t\t\tthis.rate = e.mp.detail.index;\r\n\t\t},\r\n\t\t// 长按录音，监听在页面最外层div，如果是放在button的话，手指上划离开button后获取距离变化有bug\r\n\t\thandleLongPress(e) {\r\n\t\t\tthis.startPoint = e.touches[0];\r\n\t\t\tif (e.target.id === 'record') {\r\n\t\t\t\tthis.title = '正在录音';\r\n\t\t\t\tthis.isRecording = true;\r\n\t\t\t\tthis.startRecording();\r\n\t\t\t\tthis.canSend = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tchooseRecord() {\r\n\t\t\tthis.isRecord = !this.isRecord;\r\n\t\t},\r\n\t\t// 录音时的手势上划移动距离对应文案变化\r\n\t\thandleTouchMove(e) {\r\n\t\t\tif (this.isRecording) {\r\n\t\t\t\tif (this.startPoint.clientY - e.touches[e.touches.length - 1].clientY > 100) {\r\n\t\t\t\t\tthis.title = '松开手指，取消发送';\r\n\t\t\t\t\tthis.canSend = false;\r\n\t\t\t\t} else if (this.startPoint.clientY - e.touches[e.touches.length - 1].clientY > 20) {\r\n\t\t\t\t\tthis.title = '上划可取消';\r\n\t\t\t\t\tthis.canSend = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.title = '正在录音';\r\n\t\t\t\t\tthis.canSend = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 手指离开页面滑动\r\n\t\thandleTouchEnd() {\r\n\t\t\tthis.isRecording = false;\r\n\t\t\twx.hideLoading();\r\n\t\t\trecorderManager.stop();\r\n\t\t},\r\n\t\t// 开始录音之前要判断一下是否开启权限\r\n\t\tstartRecording() {\r\n\t\t\twx.getSetting({\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tlet auth = res.authSetting['scope.record'];\r\n\t\t\t\t\tif (auth === false) {\r\n\t\t\t\t\t\t// 已申请过授权，但是用户拒绝\r\n\t\t\t\t\t\twx.openSetting({\r\n\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\tlet auth = res.authSetting['scope.record'];\r\n\t\t\t\t\t\t\t\tif (auth === true) {\r\n\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '授权成功',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '授权失败',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (auth === true) {\r\n\t\t\t\t\t\t// 用户已经同意授权\r\n\t\t\t\t\t\tthis.isRecording = true;\r\n\t\t\t\t\t\trecorderManager.start(recordOptions);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 第一次进来，未发起授权\r\n\t\t\t\t\t\twx.authorize({\r\n\t\t\t\t\t\t\tscope: 'scope.record',\r\n\t\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '授权成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: function() {\r\n\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\ttitle: '授权失败',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 滚动到列表bottom\r\n\t\tscrollToBottom() {\r\n\t\t\tif (this.isShow) {\r\n\t\t\t\twx.pageScrollTo({\r\n\t\t\t\t\tscrollTop: 99999\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tcustomModal() {\r\n\t\t\tthis.customModalVisible = !this.customModalVisible;\r\n\t\t\tthis.handleClose();\r\n\t\t},\r\n\t\tsendCustomMessage() {\r\n\t\t\tif (this.customData.length === 0 && this.customDescription.length === 0 && this.customExtension.length === 0) {\r\n\t\t\t\tthis.$store.commit('showToast', {\r\n\t\t\t\t\ttitle: '不能为空'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst message = wx.$app.createCustomMessage({\r\n\t\t\t\tto: this.$store.getters.toAccount,\r\n\t\t\t\tconversationType: this.$store.getters.currentConversationType,\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\tdata: this.customData,\r\n\t\t\t\t\tdescription: this.customDescription,\r\n\t\t\t\t\textension: this.customExtension\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.$store.commit('sendMessage', message);\r\n\t\t\twx.$app.sendMessage(message);\r\n\t\t\tthis.customModal();\r\n\t\t\tthis.customData = '';\r\n\t\t\tthis.customDescription = '';\r\n\t\t\tthis.customExtension = '';\r\n\t\t},\r\n\t\t// 失去焦点\r\n\t\tloseFocus() {\r\n\t\t\tthis.handleClose();\r\n\t\t},\r\n\t\t// 下载文件模态框\r\n\t\thandleModalShow() {\r\n\t\t\tlet that = this\r\n\t\t\tuni.showModal({\r\n\t\t\t    title: '提示',\r\n\t\t\t    content: '确定要撤回本消息吗？',\r\n\t\t\t    success: function (res) {\r\n\t\t\t        if (res.confirm) {\r\n\t\t\t\t\t\tthat.download()\r\n\t\t\t            console.log('用户点击确定');\r\n\t\t\t        } else if (res.cancel) {\r\n\t\t\t            console.log('用户点击取消');\r\n\t\t\t        }\r\n\t\t\t    }\r\n\t\t\t});\r\n\t\t\t// this.modalVisible = !this.modalVisible;\r\n\t\t},\r\n\t\t// 下载文件前判断小程序是否支持预览，只支持 office 相关文件预览\r\n\t\thandleDownload(message) {\r\n\t\t\tconst fileType = message.fileUrl.slice(message.fileUrl.lastIndexOf('.')).toLowerCase();\r\n\t\t\tconst allow = ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'pdf'];\r\n\t\t\tif (allow.indexOf(fileType) > -1) {\r\n\t\t\t\tthis.percent = 0;\r\n\t\t\t\tthis.downloadInfo = message;\r\n\t\t\t\tthis.handleModalShow();\r\n\t\t\t} else {\r\n\t\t\t\tthis.$store.commit('showToast', {\r\n\t\t\t\t\ttitle: '小程序不支持该文件预览哦',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tdownload() {\r\n\t\t\tlet that = this;\r\n\t\t\tlet downloadTask = wx.downloadFile({\r\n\t\t\t\turl: that.downloadInfo.fileUrl,\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tconsole.log('start downloading: ');\r\n\t\t\t\t},\r\n\t\t\t\tfail: function({ errMsg }) {\r\n\t\t\t\t\tthat.$store.commit('showToast', {\r\n\t\t\t\t\t\ttitle: '文件下载出错',\r\n\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\tduration: 1500\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthat.handleModalShow();\r\n\t\t\t\t},\r\n\t\t\t\tcomplete: function(res) {\r\n\t\t\t\t\tdownloadTask = null;\r\n\t\t\t\t\twx.openDocument({\r\n\t\t\t\t\t\tfilePath: res.tempFilePath,\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\tconsole.log('open file fail', res);\r\n\t\t\t\t\t\t\tthat.$store.commit('showToast', {\r\n\t\t\t\t\t\t\t\ttitle: '打开文档成功',\r\n\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\tduration: 1000\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.percent = 0;\r\n\t\t\t\t\t\t\tthat.handleModalShow();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\t\tconsole.log('open file fail', err);\r\n\t\t\t\t\t\t\tthat.$store.commit('showToast', {\r\n\t\t\t\t\t\t\t\ttitle: '小程序不支持该文件预览哦',\r\n\t\t\t\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\t\t\t\tduration: 2000\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tthat.handleModalShow();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tdownloadTask.onProgressUpdate(res => {\r\n\t\t\t\tthat.percent = res.progress;\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 群简介或者人简介\r\n\t\ttoDetail({ userID }) {\r\n\t\t\tif (userID) {\r\n\t\t\t\twx.navigateTo({ url: `../user-profile/main?userID=${userID}` });\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst conversationID = this.currentConversation.conversationID;\r\n\t\t\tthis.isGroup = this.currentConversation.type === this.TIM.TYPES.CONV_GROUP;\r\n\t\t\tif (this.isGroup) {\r\n\t\t\t\twx.navigateTo({ url: '../group-profile/main' });\r\n\t\t\t} else {\r\n\t\t\t\tlet userID = conversationID.substring(3);\r\n\t\t\t\twx.navigateTo({ url: `../user-profile/main?userID=${userID}` });\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 获取消息\r\n\t\tgetMessageList() {\r\n\t\t\t// 获取历史\r\n\t\t\tconsole.log('获取历史')\r\n\t\t\tthis.$store.dispatch('getMessageList');\r\n\t\t\twx.stopPullDownRefresh();\r\n\t\t},\r\n\t\t// 处理emoji选项卡\r\n\t\thandleEmoji() {\r\n\t\t\tif (this.isFocus) {\r\n\t\t\t\tthis.isFocus = false;\r\n\t\t\t\tthis.isMoreOpen = false;\r\n\t\t\t\tthis.isEmojiOpen = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.isEmojiOpen = !this.isEmojiOpen;\r\n\t\t\t\tthis.isMoreOpen = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 处理更多选项卡\r\n\t\thandleMore() {\r\n\t\t\tif (this.isFocus) {\r\n\t\t\t\tthis.isFocus = false;\r\n\t\t\t\tthis.isEmojiOpen = false;\r\n\t\t\t\tthis.isMoreOpen = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.isMoreOpen = !this.isMoreOpen;\r\n\t\t\t\tthis.isEmojiOpen = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 选项卡关闭\r\n\t\thandleClose() {\r\n\t\t\tthis.rateModal = false;\r\n\t\t\tthis.isFocus = false;\r\n\t\t\tthis.isMoreOpen = false;\r\n\t\t\tthis.isEmojiOpen = false;\r\n\t\t},\r\n\t\tisnull(content) {\r\n\t\t\tif (content === '') {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst reg = '^[ ]+$';\r\n\t\t\tconst re = new RegExp(reg);\r\n\t\t\treturn re.test(content);\r\n\t\t},\r\n\t\t// 发送text message 包含 emoji\r\n\t\tsendMessage() {\r\n\t\t\tif (!this.isnull(this.messageContent)) {\r\n\t\t\t\tconst message = wx.$app.createTextMessage({\r\n\t\t\t\t\tto: this.$store.getters.toAccount,\r\n\t\t\t\t\tconversationType: this.$store.getters.currentConversationType,\r\n\t\t\t\t\tpayload: { text: this.messageContent }\r\n\t\t\t\t});\r\n\t\t\t\tlet index = this.$store.state.conversation.currentMessageList.length;\r\n\t\t\t\tthis.$store.commit('sendMessage', message);\r\n\t\t\t\twx.$app.sendMessage(message).catch(() => {\r\n\t\t\t\t\tthis.$store.commit('changeMessageStatus', index);\r\n\t\t\t\t});\r\n\t\t\t\tthis.messageContent = '';\r\n\t\t\t} else {\r\n\t\t\t\tthis.$store.commit('showToast', { title: '消息不能为空' });\r\n\t\t\t}\r\n\t\t\tthis.isFocus = false;\r\n\t\t\tthis.isEmojiOpen = false;\r\n\t\t\tthis.isMoreOpen = false;\r\n\t\t},\r\n\t\tsendPhoto(name) {\r\n\t\t\tlet self = this;\r\n\t\t\tif (name === 'album') {\r\n\t\t\t\tthis.chooseImage(name);\r\n\t\t\t} else if (name === 'camera') {\r\n\t\t\t\twx.getSetting({\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tif (!res.authSetting['scope.camera']) {\r\n\t\t\t\t\t\t\t// 无权限，跳转设置权限页面\r\n\t\t\t\t\t\t\twx.authorize({\r\n\t\t\t\t\t\t\t\tscope: 'scope.camera',\r\n\t\t\t\t\t\t\t\tsuccess: function() {\r\n\t\t\t\t\t\t\t\t\tself.chooseImage(name);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tself.chooseImage(name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tvideoError(e) {\r\n\t\t\tconsole.log(e);\r\n\t\t\tthis.$store.commit('showToast', {\r\n\t\t\t\ttitle: `视频出现错误，错误信息${e.mp.detail.errMsg}`,\r\n\t\t\t\tduration: 1500\r\n\t\t\t});\r\n\t\t},\r\n\t\tchooseImage(name) {\r\n\t\t\tlet self = this;\r\n\t\t\tlet message = {};\r\n\t\t\twx.chooseImage({\r\n\t\t\t\tsourceType: [name],\r\n\t\t\t\tcount: 1,\r\n\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\tmessage = wx.$app.createImageMessage({\r\n\t\t\t\t\t\tto: self.$store.getters.toAccount,\r\n\t\t\t\t\t\tconversationType: self.$store.getters.currentConversationType,\r\n\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\tfile: res\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonProgress: percent => {\r\n\t\t\t\t\t\t\tself.percent = percent;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tself.$store.commit('sendMessage', message);\r\n\t\t\t\t\twx.$app\r\n\t\t\t\t\t\t.sendMessage(message)\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tself.percent = 0;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.handleClose();\r\n\t\t},\r\n\t\tpreviewImage(src) {\r\n\t\t\twx.previewImage({\r\n\t\t\t\tcurrent: src, // 当前显示图片的http链接\r\n\t\t\t\turls: [src]\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 发消息选中emoji\r\n\t\tchooseEmoji(item) {\r\n\t\t\tthis.messageContent += item;\r\n\t\t},\r\n\t\t// 重发消息\r\n\t\thandleResend(message) {\r\n\t\t\tif (message.status === 'fail') {\r\n\t\t\t\twx.$app.resendMessage(message);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsendSurvey() {\r\n\t\t\tif (this.customExtension) {\r\n\t\t\t\tconst message = wx.$app.createCustomMessage({\r\n\t\t\t\t\tto: this.$store.getters.toAccount,\r\n\t\t\t\t\tconversationType: this.$store.getters.currentConversationType,\r\n\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\tdata: 'survey',\r\n\t\t\t\t\t\tdescription: String(this.rate),\r\n\t\t\t\t\t\textension: this.customExtension\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tthis.rate = 0;\r\n\t\t\t\tthis.customExtension = '';\r\n\t\t\t\tthis.$store.commit('sendMessage', message);\r\n\t\t\t\twx.$app.sendMessage(message);\r\n\t\t\t\tthis.handleClose();\r\n\t\t\t} else {\r\n\t\t\t\tthis.$store.commit('showToast', {\r\n\t\t\t\t\ttitle: '建议不要为空哦！'\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 播放音频\r\n\t\topenAudio(audio) {\r\n\t\t\tlet that = this;\r\n\t\t\taudioContext.src = audio.url;\r\n\t\t\taudioContext.play();\r\n\t\t\taudioContext.onPlay(() => {});\r\n\t\t\taudioContext.onEnded(() => {\r\n\t\t\t\twx.hideToast();\r\n\t\t\t});\r\n\t\t\taudioContext.onError(() => {\r\n\t\t\t\tthat.$store.commit('showToast', {\r\n\t\t\t\t\ttitle: '小程序暂不支持播放该音频格式',\r\n\t\t\t\t\ticon: 'none',\r\n\t\t\t\t\tduration: 2000\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 发送视频消息\r\n\t\tvideo() {\r\n\t\t\tlet that = this;\r\n\t\t\twx.chooseVideo({\r\n\t\t\t\tsourceType: ['album', 'camera'],\r\n\t\t\t\tmaxDuration: 60,\r\n\t\t\t\tcamera: 'back',\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tlet message = wx.$app.createVideoMessage({\r\n\t\t\t\t\t\tto: that.$store.getters.toAccount,\r\n\t\t\t\t\t\tconversationType: that.$store.getters.currentConversationType,\r\n\t\t\t\t\t\tpayload: {\r\n\t\t\t\t\t\t\tfile: res\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthat.$store.commit('sendMessage', message);\r\n\t\t\t\t\twx.$app.sendMessage(message);\r\n\t\t\t\t\tthat.handleClose();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetRandomInt(min, max) {\r\n\t\t\tmin = Math.ceil(min);\r\n\t\t\tmax = Math.floor(max);\r\n\t\t\treturn Math.floor(Math.random() * (max - min)) + min;\r\n\t\t},\r\n\t\tvideoCall() {\r\n\t\t\tconst options = {\r\n\t\t\t\tcall_id: '',\r\n\t\t\t\tversion: 3,\r\n\t\t\t\troom_id: this.getRandomInt(0, 42949),\r\n\t\t\t\taction: 0,\r\n\t\t\t\tduration: 0,\r\n\t\t\t\tinvited_list: []\r\n\t\t\t};\r\n\t\t\tlet args = JSON.stringify(options);\r\n\t\t\tconst message = wx.$app.createCustomMessage({\r\n\t\t\t\tto: this.$store.getters.toAccount,\r\n\t\t\t\tconversationType: this.$store.getters.currentConversationType,\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\tdata: args,\r\n\t\t\t\t\tdescription: '',\r\n\t\t\t\t\textension: ''\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.$store.commit('sendMessage', message);\r\n\t\t\twx.$app.sendMessage(message);\r\n\t\t\tlet url = `../call/main?args=${args}&&from=${message.from}&&to=${message.to}`;\r\n\t\t\twx.navigateTo({ url });\r\n\t\t\tthis.handleClose();\r\n\t\t},\r\n\t\thandleEmojiShow() {\r\n\t\t\tthis.emojiShow = true;\r\n\t\t\tthis.bigEmojiShow = false;\r\n\t\t},\r\n\t\thandleBigEmojiShow() {\r\n\t\t\tthis.emojiShow = false;\r\n\t\t\tthis.bigEmojiShow = true;\r\n\t\t},\r\n\t\tchooseBigEmoji(item) {\r\n\t\t\tlet message = wx.$app.createFaceMessage({\r\n\t\t\t\tto: this.$store.getters.toAccount,\r\n\t\t\t\tconversationType: this.$store.getters.currentConversationType,\r\n\t\t\t\tpayload: {\r\n\t\t\t\t\tindex: 1,\r\n\t\t\t\t\tdata: item\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.$store.commit('sendMessage', message);\r\n\t\t\twx.$app.sendMessage(message);\r\n\t\t\tthis.handleClose();\r\n\t\t},\r\n\t\t// 长按消息触发是否撤回\r\n\t\thandleMessage(message) {\r\n\t\t\tif (message.from === this.myInfo.userID) {\r\n\t\t\t\tconst revokeTimeout = 2 * 60 * 1000;\r\n\t\t\t\tconst now = new Date().getTime();\r\n\t\t\t\tif (now - message.time * 1000 < revokeTimeout) {\r\n\t\t\t\t\t// this.revokeModal = true;\r\n\t\t\t\t\tlet that = this\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t    title: '提示',\r\n\t\t\t\t\t    content: '确定要撤回本消息吗？',\r\n\t\t\t\t\t    success: function (res) {\r\n\t\t\t\t\t        if (res.confirm) {\r\n\t\t\t\t\t\t\t\tthat.handleRevokeMessage()\r\n\t\t\t\t\t            console.log('用户点击确定');\r\n\t\t\t\t\t        } else if (res.cancel) {\r\n\t\t\t\t\t            console.log('用户点击取消');\r\n\t\t\t\t\t        }\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.revokeMessage = message;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 撤回消息\r\n\t\thandleRevokeMessage() {\r\n\t\t\twx.$app.revokeMessage(this.revokeMessage).then(res => {\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tthis.revokeModal = false;\r\n\t\t\t\tthis.$store.commit('showToast', {\r\n\t\t\t\t\ttitle: '撤回成功',\r\n\t\t\t\t\tduration: 500\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\t// 撤回后时间限制内，重新编辑\r\n\t\treEdit(message) {\r\n\t\t\tthis.messageContent = message.payload.text;\r\n\t\t}\r\n\t},\r\n\tdestory() {}\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\">\n.custom-wrapper\n\twidth 100%\n\tdisplay flex\n\tflex-direction column\n\tjustify-content center\n\tpadding 0 12px\n\tbox-sizing border-box\n\t.custom-input\n\t\tcolor $base\n\t\tbackground-color white\n\t\tborder-radius 8px\n\t\theight 30px\n\t\tmargin 5px 0\n\t\tbox-sizing border-box\n\t\tborder-bottom 1px solid $light-background\n.loadMore\n\tfont-size 14px\n\tcolor #8a8a8a\n\tbox-sizing border-box\n\twidth 100%\n\tpadding 15px\n\tdisplay flex\n\tjustify-content center\n.unload\n\tfont-size 0\n\tcolor #fff\n\tbox-sizing border-box\n\twidth 100%\n\ttext-align center\n.emoji-open\n\theight calc(100vh - 262px)\n.emoji-close\n\theight calc(100vh - 82px)\n.chat\n\tbackground-color #f5f5f5\n\tbox-sizing border-box\r\n\toverflow  auto\n.file\n\tdisplay flex\n\ttext-align left\n\twidth fit-content\n\tword-break break-all\n\tfont-size 14px\n\tbackground-color white\n\tpadding 10px 8px\n.bottom\n\tbackground-color #f0f0f0\n\tposition fixed\n\tbottom 0\n\tleft 0\n\twidth 100%\n.bottom-div\n\twidth 100%\n\tdisplay flex\n\talign-items center\n\tborder-top 1px solid $border\n\tpadding 10px\n\tflex-direction row\n\tbox-sizing border-box\n\ttransition all 0.3s\n\t.send\n\t\tfont-size 14px\n\t\tbackground-color $primary\n\t\tcolor white\n\t\tborder-radius 4px\n\t\twidth 56px\n\t\theight fit-content\n\t\tpadding 4px\n\t\tmargin-left 10rpx\n\t\ttext-align center\n.bottom-emoji\n\tposition relative\n\t.emojis\n\t\theight 150px\n\t\tdisplay flex\n\t\tflex-direction row\n\t\tflex-wrap wrap\n\t\toverflow-y scroll\n\t\tbox-sizing border-box\n\t\t.emoji\n\t\t\theight 12.5vw\n\t\t\twidth 12.5vw\n\t\t\tpadding 8px\n\t\t\tbox-sizing border-box\n\t\t.bigemoji\n\t\t\theight 20vw\n\t\t\twidth 20vw\n\t\t\tpadding 10px\n\t\t\tbox-sizing border-box\n.emoji-tab\n\tbox-sizing border-box\n\tborder-bottom 1px solid $border-base\n\t.tabs\n\t\tdisplay flex\n\t\theight 29px\n\t\tflex-direction row\n\t\tpadding-left 10px\n\t\tbox-sizing border-box\n\t\t.single\n\t\t\tdisplay flex\n\t\t\tmargin-top 2px\n\t\t\twidth 26px\n\t\t\theight 26px\n\t\t\tpadding 2px\n\t\t\tborder-radius 6px\n\t\t\tbox-sizing border-box\n\t\t\tmargin-right 8px\n\t\t.choosed\n\t\t\tbackground-color rgba(255, 255, 255, 0.7)\n.bottom-image\n\tbox-sizing border-box\n\t.images\n\t\tbox-sizing border-box\n\t\tdisplay flex\n\t\tpadding 0 12px\n\t\tmargin-top 16px\n\t\t&:last-child\n\t\t\tmargin-bottom 16px\n\t\t.block\n\t\t\tbox-sizing border-box\n\t\t\tdisplay flex\n\t\t\tflex-direction column\n\t\t\tjustify-content center\n\t\t\talign-items center\n\t\t\tmargin 0 12px\n\t\t\t.name\n\t\t\t\tmargin-top 6px\n\t\t\t\tfont-size 12px\n\t\t\t\tcolor $secondary\n\t\t\t\ttext-align center\n\t\t\t.image\n\t\t\t\twidth 64px\n\t\t\t\theight 64px\n\t\t\t\tdisplay flex\n\t\t\t\tjustify-content center\n\t\t\t\talign-items center\n\t\t\t\tbox-sizing border-box\n\t\t\t\tborder-radius 8px\n\t\t\t\tbackground-color white\n\t\t\t\tpadding 3vw\n\t\t\t\t.icon\n\t\t\t\t\twidth 26px\n\t\t\t\t\theight 26px\n.input\n\tbackground-color white\n\tborder-radius 6px\n\theight 34px\n\tbox-sizing border-box\n\tpadding 0 8px\n.btn-left\n\tdisplay flex\n\tpadding 0\n\tmargin 0\n\tmargin-right 10px\n.btn\n\tdisplay flex\n\tpadding 0\n\tmargin 0\n\tmargin-left 10px\n.button\n\tcolor white\n\tbackground-color $primary\n\tborder-radius 8px\n\theight 26px\n\tpadding 0 6px\n\tline-height 26px\n\tfont-size 16px\n// 添加用户当弹窗\n.input-wrapper\n\twidth 100%\n\tdisplay flex\n\tjustify-content center\nli\n\tmargin-top 18px\n\tpadding 0 12px\n.fail::before\n\tpadding 2px 8px\n\tbackground-color $danger\n\tcolor white\n\tcontent '!'\n\tfont-size 12px\n\tborder-radius 50%\n\tcursor pointer\n@keyframes load\n\tfrom\n\t\ttransform rotate(0deg)\n\tto\n\t\ttransform rotate(360deg)\n.notice\n\tdisplay flex\n\tjustify-content center\n\tmargin-bottom 10px\n\t.content\n\t\tbackground-color $background\n\t\tborder-radius 8px\n\t\tfont-size 14px\n\t\tcolor $regular\n\t\tpadding 6px 8px\n.message\n\tfont-size 16px\n\tline-height 22px\n\ttext-align left\n\twidth fit-content\n\tword-break break-all\r\n\tbackground-color #95ec69\n\t// background-color $dark-background\n\tpadding 8px\n.text-message\n\tdisplay flex\n\tflex-direction row\n\tflex-wrap wrap\n\twhite-space pre-wrap\n.image-message\n\tmax-width 180px\n\tborder-radius 2px\n.fail\n\tbackground-color transparent\n.unSend\n\twidth 12px\n\theight 12px\n\tborder 4px solid $light-primary\n\tborder-bottom $border-base 4px solid\n\tborder-radius 50%\n\t-webkit-animation load 1.1s infinite linear\n.item-right\n\tdisplay flex\n\tflex-direction row\n\tjustify-content flex-end\n\theight 100%\n\t.load\n\t\theight 100%\n\t\twidth 30px\n\t\tdisplay flex\n\t\tflex-direction column\n\t\tjustify-content center\n\t.content\n\t\tmargin-right 12px\n\t\tdisplay flex\n\t\tflex-direction column\n\t\talign-items flex-end\r\n\t\tposition relative\r\n\t\t.arrow\r\n\t\t\tposition absolute\r\n\t\t\tright -12px\r\n\t\t\ttop 30px\r\n\t\t\tborder 6px solid transparent\r\n\t\t\tborder-left 6px solid #95ec69\n\t\t.name\n\t\t\twidth 100%\n\t\t\tfont-size 12px\n\t\t\tline-height 1\n\t\t\tmargin-bottom 6px\n\t\t\tcolor $secondary\n\t\t\ttext-align right\n\t\t.wrapper\n\t\t\tdisplay flex\n\t\t\tflex-direction row\n\t\t\theight 100%\n\t\t\t.message\n\t\t\t\tbackground-color $primary-10\n\t\t\t\tborder 1px solid $primary-30\n\t\t\t\tborder-radius 4px\n.survey\n\tpadding 20px\n\tbackground-color white\n\t.title\n\t\tfont-size 16px\n\t\tfont-weight 600\n\t.rate\n\t\tdisplay flex\n\t\tflex-direction flex-start\n\t\talign-content center\n\t\t.star\n\t\t\twidth 30px\n\t\t\theight 30px\n\t\t.rating\n\t\t\tfont-weight 600\n\t\t\tcolor $regular\n\t\t\tline-height 30px\n\t\t\tpadding-left 10px\n\t.suggestion\n\t\tpadding-top 10px\n\t\tfont-size 14px\n\t\tcolor $black\n\t\tfont-weight 500\n\t.description\n\t\tfont-size 18px\n\t\tcolor $black\n.video\n\tmax-height 200px\n\tmax-width 50vw\n.item-left\n\tdisplay flex\n\tflex-direction row-reverse\n\tjustify-content flex-end\n\t.content\n\t\tmargin-left 10px\r\n\t\tposition relative\n\t\t.name\n\t\t\twidth 100%\n\t\t\tfont-size 12px\n\t\t\tline-height 1\n\t\t\tcolor $secondary\n\t\t\tmargin-bottom 6px\n\t\t.message\n\t\t\tbackground-color #ffffff\n\t\t\tborder 1px solid $light-background\n\t\t\tborder-radius 4px\r\n\t\t.arrow\r\n\t\t\t// background-color #f8f8f8\r\n\t\t\tposition absolute\r\n\t\t\tleft -12px\r\n\t\t\ttop 30px\r\n\t\t\tborder 6px solid transparent\r\n\t\t\tborder-right 6px solid #ffffff\r\n\t\t\t\n// 音频解析\n.box\n\tdisplay flex\n\theight 20px\n\tline-height 20px\n.record\n\twidth 100%\n\tbackground-color white\n\tcolor $regular\n\tborder-radius 6px\n\tbox-sizing border-box\n\theight 34px\n\tline-height 34px\n\tdisplay flex\n\tjustify-content center\n.record-modal\n\theight 150px\n\twidth 60vw\n\tbackground-color black\n\topacity 0.8\n\tposition fixed\n\ttop 200px\n\tz-index 9999\n\tleft 20vw\n\tborder-radius 12px\n\tdisplay flex\n\tflex-direction column\n\t.wrapper\n\t\tdisplay flex\n\t\theight 100px\n\t\tbox-sizing border-box\n\t\tpadding 10vw\n\t\t.modal-loading\n\t\t\topacity 1\n\t\t\twidth 20px\n\t\t\theight 8px\n\t\t\tborder-radius 2px\n\t\t\tbackground-color $primary\n\t\t\tanimation loading 2s cubic-bezier(0.17, 0.37, 0.43, 0.67) infinite\n\t.modal-title\n\t\ttext-align center\n\t\tcolor white\n@keyframes loading\n\t0%\n\t\ttransform translate(0, 0)\n\t50%\n\t\ttransform translate(30vw, 0)\n\t\tbackground-color #f5634a\n\t\twidth 40px\n\t100%\n\t\ttransform translate(0, 0)\n.modal-display\n\tdisplay none\n.avatar\n\theight 40px !important\n\twidth 40px !important\n\tborder-radius 4px !important\n.float-button-list\n\tposition fixed\n\ttop 12px\n\tright 12px\n\timage\n\t\twidth 20px\n\t\theight 20px\n\t\tpadding 7px\n\t\tbox-shadow 0 0 4px gray\n\t\tbackground-color $background\n\t\tborder-radius 50%\n\t.video-icon\n\t\tmargin-right 6px\n.re-edit\n\tcolor $primary\n\tline-height 30px\n\tfont-size 14px\n\tmargin-left 10px\n</style>\n","import mod from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/stylus-loader/index.js??ref--11-oneOf-1-4!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-5!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=stylus&\"; export default mod; export * from \"-!../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-2!../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-3!../../../HBuilderX/plugins/uniapp-cli/node_modules/stylus-loader/index.js??ref--11-oneOf-1-4!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-5!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=stylus&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1597653908649\n      var cssReload = require(\"F:/my/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}