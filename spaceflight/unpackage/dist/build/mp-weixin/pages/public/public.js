(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/public"],{2843:function(t,e,a){"use strict";var i=a("a410"),n=a.n(i);n.a},"4dcf":function(t,e,a){"use strict";a.r(e);var i=a("7789"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},5964:function(t,e,a){"use strict";(function(t){a("e91d");i(a("66fd"));var e=i(a("d23e"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},7789:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(a("ba6d")),n=a("8442");function o(t){return t&&t.__esModule?t:{default:t}}var s=function(){a.e("components/uni-popup/uni-popup").then(function(){return resolve(a("a661"))}.bind(null,a)).catch(a.oe)},d={data:function(){return{Color:"#333",backColor:"#fff",nav:[{name:"发布需求",id:1},{name:"寻找需求",id:2}],navId:1,navIndex:0,tit:"",val:"",add:"",label:[],imgs:[],videos:[],banner:[],id:"",type:-1}},onLoad:function(t){0==t.type&&(this.type=t.type,this.id=t.id),this.init()},components:{uniPopup:s},methods:{changeNav:function(t){0!=this.type&&(this.navIndex=t,this.navId=this.nav[t].id)},changeLabel:function(t){this.label[t].state=!this.label[t].state,this.$forceUpdate()},goPreview2:function(e){t.previewImage({current:e,urls:this.banner})},goDel2:function(t){this.banner.splice(t,1)},goPreview:function(e){t.previewImage({current:e,urls:this.imgs})},goDel:function(t){this.imgs.splice(t,1)},goDel1:function(t){this.videos.splice(t,1)},editor:function(e){var a=this,o={uid:t.getStorageSync("uid"),gxId:e};i.default.showLoading("",(function(){var t={url:"/api/editGongXuInfo",data:o,success:function(t){if(console.log(t),0==t.data.result){i.default.hideLoading(),a.tit=t.data.dateList.title,a.banner.push(t.data.dateList.imageUrl),a.val=t.data.dateList.content,t.data.dateList.imageUrls&&(a.imgs=t.data.dateList.imageUrls),t.data.dateList.vedioUrl&&(a.videos=t.data.dateList.vedioUrl);for(var e=t.data.dateList.lablesId,n=0;n<e.length;n++)for(var o=0;o<a.label.length;o++)e[n]==a.label[o].id&&(a.label[o].state=!0);a.add=t.data.dateList.lable,a.navIndex=parseInt(t.data.dateList.gongXuType)-1,a.$forceUpdate()}else i.default.hideLoading(),i.default.showToast(t.data.resultNote)}};(0,n.ajax)(t)}))},init:function(t){var e=this,a={};i.default.showLoading("",(function(){var t={url:"/api/lableList",data:a,success:function(t){console.log(t),0==t.data.result?(i.default.hideLoading(),e.label=t.data.dateList,e.label.forEach((function(t,e){t.state=!1})),0==e.type&&e.editor(e.id)):(i.default.hideLoading(),i.default.showToast(t.data.resultNote))}};(0,n.ajax)(t)}))},showPopup:function(){var t=this;this.imgs.length>=3?i.default.showToast("最多上传3张图片"):this.$nextTick((function(){t.$refs["showpopup"].open()}))},upHead:function(){var e=this;1!=e.banner.length?t.chooseImage({count:1,sizeType:["original","compressed"],success:function(a){i.default.showLoading("上传中...",(function(){a.tempFilePaths.forEach((function(a,n){t.uploadFile({url:"https://zhr.lexishangcheng.com/api/addimgs",filePath:a,name:"file",success:function(t){i.default.hideLoading();var a=JSON.parse(t.data);e.banner.push(a.dataList[0])},fail:function(t){i.default.hideLoading(),i.default.showToast("上传失败")}})}))}))},fail:function(t){i.default.hideLoading(),i.default.showToast("上传失败")}}):i.default.showToast("封面图只能上传一张")},goPicture:function(){this.$refs["showpopup"].close();var e=this;t.chooseImage({count:3,sizeType:["original","compressed"],success:function(a){i.default.showLoading("上传中...",(function(){a.tempFilePaths.forEach((function(a,n){t.uploadFile({url:"https://zhr.lexishangcheng.com/api/addimgs",filePath:a,name:"file",success:function(t){i.default.hideLoading(),e.videos=[];var a=JSON.parse(t.data);e.imgs.push(a.dataList[0])},fail:function(t){i.default.hideLoading(),i.default.showToast("上传失败")}})}))}))},fail:function(t){i.default.hideLoading(),i.default.showToast("上传失败")}})},goVideo:function(){this.$refs["showpopup"].close();var e=this;t.chooseVideo({compressed:!0,maxDuration:60,success:function(a){a.duration>300?i.default.showToast("上传视频不能超过5分钟"):(console.log(a),i.default.showLoading("上传中...",(function(){var n=t.uploadFile({url:"https://zhr.lexishangcheng.com/api/addimgs",filePath:a.tempFilePath,name:"file",success:function(t){console.log(t),i.default.hideLoading(),e.imgs=[];var a=JSON.parse(t.data);e.videos.push(a.dataList[0]),console.log(e.videos)},fail:function(t){i.default.hideLoading(),i.default.showToast("上传失败")}});n.onProgressUpdate((function(t){console.log("上传进度"+t.progress),console.log("已经上传的数据长度"+t.totalBytesSent),console.log("预期需要上传的数据总长度"+t.totalBytesExpectedToSend)}))})))},fail:function(t){console.log(JSON.stringify(t)),i.default.hideLoading(),i.default.showToast("上传失败了")}})},submit:function(){if(""!=this.tit)if(0!=this.banner.length)if(""!=this.val)if(0!=this.imgs.length||0!=this.videos.length){var e=[];this.label.forEach((function(t,a){t.state&&e.push(t.id)}));var a={uid:t.getStorageSync("uid"),type:this.navId,gxId:"",title:this.tit,image:this.banner.join(","),imageUrls:this.imgs.join(","),videoUrl:this.videos.join(","),lables:this.add,lableId:e.join(","),content:this.val};i.default.showLoading("",(function(){var e={url:"/api/addMyGX",data:a,success:function(e){console.log(e),0==e.data.result?(i.default.hideLoading(),i.default.showToast("已提交后台审核"),setTimeout((function(){t.navigateBack({delta:1})}),500)):(i.default.hideLoading(),i.default.showToast(e.data.resultNote))}};(0,n.ajax)(e)}))}else i.default.showToast("请上传图片或者视频");else i.default.showToast("供需内容不能为空");else i.default.showToast("请上传封面图");else i.default.showToast("供需标题不能为空")}}};e.default=d}).call(this,a("543d")["default"])},a410:function(t,e,a){},d23e:function(t,e,a){"use strict";a.r(e);var i=a("ee39"),n=a("4dcf");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("2843");var s,d=a("f0c5"),u=Object(d["a"])(n["default"],i["b"],i["c"],!1,null,"a9af5c74",null,!1,i["a"],s);e["default"]=u.exports},ee39:function(t,e,a){"use strict";var i={uniPopup:function(){return a.e("components/uni-popup/uni-popup").then(a.bind(null,"a661"))}},n=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}))}},[["5964","common/runtime","common/vendor"]]]);