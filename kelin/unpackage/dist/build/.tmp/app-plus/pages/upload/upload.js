(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/upload/upload"],{1657:function(e,t,o){"use strict";o.r(t);var a=o("3eb2"),i=o.n(a);for(var n in a)"default"!==n&&function(e){o.d(t,e,function(){return a[e]})}(n);t["default"]=i.a},"3eb2":function(e,t,o){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=s(o("56cf")),n=o("b992");function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return r(e)||d(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function r(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}var c=function(){return o.e("components/popup/uni-popup").then(o.bind(null,"c50a"))},f={data:function(){return{Color:"#333",type:"型号",text:"",ids:"",list:[],videoList:[],videoUrl:"",show:!1,index:0,array:[]}},components:{uniPopup:c},onShow:function(){this.message=e.getStorageSync("message"),this.init()},methods:{init:function(){var e=this,t={Token:this.message.Token};i.default.showLoading("加载中...",function(){var o={url:"/app/service/product/all",data:t,success:function(t){1==t.data.success?(i.default.hideLoading(),e.array=t.data.body.list,e.ids=e.array[0].id,e.$store.state.id&&e.array.forEach(function(t,o){t.id==e.$store.state.id&&(e.ids=t.id,e.index=o)})):(i.default.hideLoading(),i.default.showToast(t.data.msg))}};(0,n.ajax)(o)})},bindPickerChange:function(e){console.log(a("picker发送选择改变，携带值为："+e.target.value," at pages\\upload\\upload.vue:120")),this.index=e.target.value;var t=this.array[this.index].id;this.$store.commit("changeId",t)},change:function(e){console.log(a("是否打开:"+e.show," at pages\\upload\\upload.vue:126"))},showPopup:function(){var e=this;this.$nextTick(function(){e.$refs["showpopup"].open()})},goPicture:function(){this.$refs["showpopup"].close();var t=this;e.chooseImage({count:3,sizeType:["original","compressed"],success:function(o){i.default.showLoading("上传中...",function(){o.tempFilePaths.forEach(function(o,a){e.uploadFile({url:"https://sale.clingcenter.net/app/service/file/upload",filePath:o,name:"files",formData:{Token:t.message.Token},success:function(e){i.default.hideLoading();var o=JSON.parse(e.data);t.list.push(o.body.files)},fail:function(e){i.default.hideLoading(),i.default.showToast("上传失败")}})})})},fail:function(e){i.default.hideLoading(),i.default.showToast("上传失败")}})},preview:function(){e.previewImage({urls:this.list,success:function(e){console.log(a(JSON.stringify(e)," at pages\\upload\\upload.vue:174"))},fail:function(e){console.log(a(e.errMsg," at pages\\upload\\upload.vue:177"))}})},dataURLtoFile:function(e,t){var o=e.split(","),a=o[0].match(/:(.*?);/)[1],i=atob(o[1]),n=i.length,s=new Uint8Array(n);while(n--)s[n]=i.charCodeAt(n);return new File([s],t,{type:a})},goVideo:function(){this.$refs["showpopup"].close();var t=this;e.chooseVideo({compressed:!1,success:function(o){i.default.showLoading("上传中...",function(){var n=e.uploadFile({url:"https://sale.clingcenter.net/app/service/file/upload",filePath:o.tempFilePath,name:"files",formData:{Token:t.message.Token},success:function(e){i.default.hideLoading();var o=JSON.parse(e.data);t.videoList.push(o.body.files),t.videoUrl=o.body.files},fail:function(e){console.log(a(JSON.stringify(e)," at pages\\upload\\upload.vue:217")),i.default.hideLoading(),i.default.showToast("上传失败")}});n.onProgressUpdate(function(e){console.log(a("上传进度"+e.progress," at pages\\upload\\upload.vue:224")),console.log(a("已经上传的数据长度"+e.totalBytesSent," at pages\\upload\\upload.vue:225")),console.log(a("预期需要上传的数据总长度"+e.totalBytesExpectedToSend," at pages\\upload\\upload.vue:226"))})})},fail:function(e){console.log(a(JSON.stringify(e)," at pages\\upload\\upload.vue:231")),i.default.hideLoading(),i.default.showToast("上传失败了")}})},goPlay:function(e){this.show=!0,this.videoUrl=this.videoList[e]},delPicture:function(e){this.list.splice(e,1)},delVideo:function(e){this.videoList.splice(e,1)},hideVideo:function(){this.show=!1},goSubmit:function(){var e=this;if(""!=this.text)if(0!=this.list.length||0!=this.videoList.length){var t=[].concat(u(this.list),u(this.videoList)),o="";o=1==t.length?t[0]:t.join("|"),console.log(a(this.ids," at pages\\upload\\upload.vue:310"));var s={Token:this.message.Token,product:this.ids,describes:this.text,files:o};i.default.showLoading("上传中...",function(){var t={url:"/app/service/user/upload",data:s,success:function(t){1==t.data.success?(i.default.hideLoading(),e.text="",e.list=[],e.videoList=[],i.default.showToast("上传成功")):(i.default.hideLoading(),i.default.showToast(t.data.msg))}};(0,n.ajax)(t)})}else i.default.showToast("请上传图片或者视频");else i.default.showToast("描述内容不能为空")},goReport:function(){e.navigateTo({url:"/pages/history/history"})}}};t.default=f}).call(this,o("6e42")["default"],o("0de9")["default"])},8606:function(e,t,o){"use strict";o.r(t);var a=o("ea1e"),i=o("1657");for(var n in i)"default"!==n&&function(e){o.d(t,e,function(){return i[e]})}(n);o("f3e8");var s,u=o("f0c5"),l=Object(u["a"])(i["default"],a["b"],a["c"],!1,null,"df628fdc",null,!1,a["a"],s);t["default"]=l.exports},cad0:function(e,t,o){},e558:function(e,t,o){"use strict";(function(e){o("0ad5"),o("921b");a(o("66fd"));var t=a(o("8606"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("6e42")["createPage"])},ea1e:function(e,t,o){"use strict";var a,i=function(){var e=this,t=e.$createElement,a=(e._self._c,o("0f31")),i=o("64b6"),n=o("887d"),s=o("60f2"),u=o("887d");e.$mp.data=Object.assign({},{$root:{m0:a,m1:i,m2:n,m3:s,m4:u}})},n=[];o.d(t,"b",function(){return i}),o.d(t,"c",function(){return n}),o.d(t,"a",function(){return a})},f3e8:function(e,t,o){"use strict";var a=o("cad0"),i=o.n(a);i.a}},[["e558","common/runtime","common/vendor"]]]);