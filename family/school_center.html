<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<title>校园中心</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<link rel="stylesheet" href="css/demo.css" />
		<link rel="stylesheet" href="css/mui.min.css">
		<link rel="stylesheet" href="css/school_center.css" />
		<style>
			.mui-content-padded {
				position: fixed;
				width: 100%;
				margin: 0 !important;
				background: #fff;
				z-index: 20;
			}
			
			.mui-segmented-control {
				border: none;
				display: flex;
				align-items: center;
				margin-top: 60px;
			}
			
			.mui-segmented-control .mui-control-item {
				color: #333;
				width: 25%;
				border: none;
				display: flex;
				flex-direction: column;
				align-items: center;
			}
			
			.mui-scroll {
				height: 100%;
			}
			
			.mui-active {
				color: #333 !important;
				background: #fff !important;
			}
		</style>
	</head>

	<body>
		<div id="app" class="list" v-cloak>
			<div class="mui-content-padded">
				<div class="navTop">
					校园中心
					<img class="back" src="./images/back_top.png" @tap="goBack" />
				</div>
				<div class="mui-segmented-control">
					<a href="#item1" class="mui-control-item">
						<img src="./images/news.png" alt="" />
						<span>校园新闻</span>
					</a>
					<a href="#item2" class="mui-control-item">
						<img src="./images/content.png" alt="" />
						<span>园所简介</span>
					</a>
					<a href="#item3" class="mui-control-item">
						<img src="./images/fengcai.png" alt="" />
						<span>校园风采</span>
					</a>
					<a href="#item4" class="mui-control-item">
						<img src="./images/teacher.png" alt="" />
						<span>教师风采</span>
					</a>
				</div>
			</div>
			<div class="news_box">
				<div id="item1" class="mui-control-content mui-active">
					<div id="load1" class="bg">
						<div class="loading">
							<img src="images/loading.gif" alt="" />
						</div>
					</div>
					<iframe id="list1" :src="obj.schoolnews" frameborder="0" scrolling="auto"></iframe>
				</div>
				<div id="item2" class="mui-control-content">
					<div id="load2" class="bg">
						<div class="loading">
							<img src="images/loading.gif" alt="" />
						</div>
					</div>
					<iframe id="list2" :src="obj.schooldesc" frameborder="0" scrolling="auto"></iframe>
				</div>
				<div id="item3" class="mui-control-content">
					<div id="load3" class="bg">
						<div class="loading">
							<img src="images/loading.gif" alt="" />
						</div>
					</div>
					<iframe id="list3" :src="obj.schoolelegant" frameborder="0" scrolling="auto"></iframe>
				</div>
				<div id="item4" class="mui-control-content">
					<div id="load4" class="bg">
						<div class="loading">
							<img src="images/loading.gif" alt="" />
						</div>
					</div>
					<iframe id="list4" :src="obj.teacherelegant" frameborder="0" scrolling="auto"></iframe>
				</div>
			</div>
		</div>
		<script src="js/flexible.js"></script>
		<script src="js/mui.min.js"></script>
		<script src="js/jquery.js"></script>
		<script src="js/vue.js"></script>
		<script src="js/common.js"></script>
		<script src="js/app.js"></script>
		<script>
			mui.init();
			var center = new Vue({
				el: "#app",
				data: {
					obj: {},
					tabIndex: 0
				},
				mounted: function() {
					this.onLoad();
				},
				methods: {
					onLoad: function() {
						var that = this;
						var id = setInterval(function() {
							var state = app.getState();
							var uid = state.uid;
							if(uid == undefined) {
								return
							} else {
								clearInterval(id);
								var datas = {
									cmd: "schoolcenter",
									uid: uid
								}
								ajax(datas, that.successLoad);
							}
						}, 400);
					},
					successLoad: function(res) {
						if(res.result == 0) {
							this.obj = res.dataobject;
							loadEnd('list1', 'load1');
							loadEnd('list2', 'load2');
							loadEnd('list3', 'load3');
							loadEnd('list4', 'load4');
						}
					},
					goBack: function() {
						console.log(111);
						window.location.href = "./first.html";
					}
				}
			});

			//iframe窗口加载状态
			function loadEnd(id, ids) {
				var list = document.getElementById(id);
				document.getElementById(ids).style.display = 'block';
				if(list) {
					list.onload = function() {
						document.getElementById(ids).style.display = 'none';
						list.height = document.documentElement.clientHeight || document.body.clientHeight;
					}
				}
			}
		</script>
	</body>

</html>